DROP TABLE IF EXISTS NEXUS;

CREATE TABLE NEXUS (
       ID INT NOT NULL AUTO_INCREMENT
     , FIRST_NAME VARCHAR(66) NOT NULL
     , LAST_NAME VARCHAR(44) NOT NULL
     , BIRTH_DATE DATE
     , VERSION INT NOT NULL DEFAULT 0
     , UNIQUE UQ_NEXUS_1 (FIRST_NAME, LAST_NAME)
     , PRIMARY KEY (ID)
);

CREATE TABLE HABIT (
       HABIT_ID VARCHAR(22) NOT NULL
     , PRIMARY KEY (HABIT_ID)
);

CREATE TABLE NEXUS_HABIT_DETAIL (
       NEXUS_ID INT NOT NULL
     , HABIT_ID VARCHAR(22) NOT NULL
     , PRIMARY KEY (NEXUS_ID, HABIT_ID)
     , CONSTRAINT FK_NEXUS_HABIT_DETAIL_1 FOREIGN KEY (NEXUS_ID)
                  REFERENCES NEXUS (ID) ON DELETE CASCADE
     , CONSTRAINT FK_NEXUS_HABIT_DETAIL_2 FOREIGN KEY (HABIT_ID)
                  REFERENCES HABIT (HABIT_ID)
);